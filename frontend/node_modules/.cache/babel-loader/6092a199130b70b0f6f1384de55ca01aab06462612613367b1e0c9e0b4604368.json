{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { api } from '../services/api';\nexport function useAuth() {\n  _s();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const refresh = () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setUser(null);\n      setLoading(false);\n      return;\n    }\n    setLoading(true);\n    api.get('/me').then(res => {\n      var _ref, _res$data$user, _res$data;\n      return setUser((_ref = (_res$data$user = (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.user) !== null && _res$data$user !== void 0 ? _res$data$user : res.data) !== null && _ref !== void 0 ? _ref : null);\n    }).catch(() => {\n      localStorage.removeItem('token');\n      setUser(null);\n    }).finally(() => setLoading(false));\n  };\n  useEffect(() => {\n    refresh();\n  }, []);\n  const logout = () => {\n    localStorage.removeItem('token');\n    window.location.href = '/login';\n  };\n  return {\n    user,\n    loading,\n    logout,\n    refresh\n  };\n}\n_s(useAuth, \"NiO5z6JIqzX62LS5UWDgIqbZYyY=\");","map":{"version":3,"names":["useEffect","useState","api","useAuth","_s","user","setUser","loading","setLoading","refresh","token","localStorage","getItem","get","then","res","_ref","_res$data$user","_res$data","data","catch","removeItem","finally","logout","window","location","href"],"sources":["D:/Uknord5he/BH3/dev/diplomas/frontend/src/hooks/useAuth.js"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { api } from '../services/api';\r\n\r\nexport function useAuth() {\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const refresh = () => {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) { setUser(null); setLoading(false); return; }\r\n        setLoading(true);\r\n        api.get('/me')\r\n            .then((res) => setUser(res.data?.user ?? res.data ?? null))\r\n            .catch(() => { localStorage.removeItem('token'); setUser(null); })\r\n            .finally(() => setLoading(false));\r\n    };\r\n\r\n    useEffect(() => { refresh(); }, []);\r\n\r\n    const logout = () => { localStorage.removeItem('token'); window.location.href = '/login'; };\r\n\r\n    return { user, loading, logout, refresh };\r\n}\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,GAAG,QAAQ,iBAAiB;AAErC,OAAO,SAASC,OAAOA,CAAA,EAAG;EAAAC,EAAA;EACtB,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGL,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAACM,OAAO,EAAEC,UAAU,CAAC,GAAGP,QAAQ,CAAC,IAAI,CAAC;EAE5C,MAAMQ,OAAO,GAAGA,CAAA,KAAM;IAClB,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAI,CAACF,KAAK,EAAE;MAAEJ,OAAO,CAAC,IAAI,CAAC;MAAEE,UAAU,CAAC,KAAK,CAAC;MAAE;IAAQ;IACxDA,UAAU,CAAC,IAAI,CAAC;IAChBN,GAAG,CAACW,GAAG,CAAC,KAAK,CAAC,CACTC,IAAI,CAAEC,GAAG;MAAA,IAAAC,IAAA,EAAAC,cAAA,EAAAC,SAAA;MAAA,OAAKZ,OAAO,EAAAU,IAAA,IAAAC,cAAA,IAAAC,SAAA,GAACH,GAAG,CAACI,IAAI,cAAAD,SAAA,uBAARA,SAAA,CAAUb,IAAI,cAAAY,cAAA,cAAAA,cAAA,GAAIF,GAAG,CAACI,IAAI,cAAAH,IAAA,cAAAA,IAAA,GAAI,IAAI,CAAC;IAAA,EAAC,CAC1DI,KAAK,CAAC,MAAM;MAAET,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC;MAAEf,OAAO,CAAC,IAAI,CAAC;IAAE,CAAC,CAAC,CACjEgB,OAAO,CAAC,MAAMd,UAAU,CAAC,KAAK,CAAC,CAAC;EACzC,CAAC;EAEDR,SAAS,CAAC,MAAM;IAAES,OAAO,CAAC,CAAC;EAAE,CAAC,EAAE,EAAE,CAAC;EAEnC,MAAMc,MAAM,GAAGA,CAAA,KAAM;IAAEZ,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC;IAAEG,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;EAAE,CAAC;EAE3F,OAAO;IAAErB,IAAI;IAAEE,OAAO;IAAEgB,MAAM;IAAEd;EAAQ,CAAC;AAC7C;AAACL,EAAA,CAnBeD,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}